{
  "agent_id": "",
  "channel": "voice",
  "last_modification_timestamp": 1760009474289,
  "agent_name": "{{agent_name}}",
  "response_engine": {
    "type": "conversation-flow",
    "version": 0,
    "conversation_flow_id": "conversation_flow_9a1ca568d808"
  },
  "language": "en-US",
  "opt_out_sensitive_data_storage": false,
  "data_storage_setting": "everything",
  "opt_in_signed_url": false,
  "version": 0,
  "is_published": false,
  "version_title": "",
  "post_call_analysis_model": "gpt-4o-mini",
  "pii_config": {
    "mode": "post_call",
    "categories": [
      "date_of_birth",
      "address",
      "ssn",
      "passport",
      "credit_card",
      "bank_account",
      "password",
      "pin",
      "medical_id",
      "customer_account_number",
      "driver_license"
    ]
  },
  "voice_id": "11labs-Cimo",
  "enable_backchannel": false,
  "max_call_duration_ms": 600000,
  "interruption_sensitivity": 0.9,
  "allow_user_dtmf": true,
  "user_dtmf_options": {},
  "retellLlmData": null,
  "conversationFlow": {
    "conversation_flow_id": "conversation_flow_9a1ca568d808",
    "version": 0,
    "global_prompt": "",
    "nodes": [
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nAnalyze caller's request and route to appropriate conversation path. Listen carefully to their complete request before routing.\n\n## Approach\n- Let caller finish speaking completely\n- Identify primary intent from their request\n- Route immediately if intent is clear\n- Ask ONE clarifying question if intent is ambiguous\n\n## Business Context\nBusiness: {{business_name}} - {{business_description}}\nServices: {{appointment_types}}\nHours: {{business_hours}}\n\n## Transition Triggers\n- If caller mentions \"my appointment\" or asks about existing booking → Route to appointment identification\n- If caller asks about services, hours, or general business info → Route to Q&A\n- If caller says \"book\", \"schedule\", \"appointment\" for NEW booking → Route to appointment booking\n- If caller wants to \"change\", \"reschedule\", \"cancel\" existing appointment → Route to appointment identification\n- If caller asks for human or says \"transfer\" → Route to escalation\n- If intent unclear after listening → Ask: \"Are you looking to schedule a new appointment, check on an existing one, or do you have questions about our services?\"\n\nCurrent date/time: {{dayAndTime}}"
        },
        "name": "Router",
        "edges": [
          {
            "destination_node_id": "node-1759299298668",
            "id": "edge-1759306500001",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller asks about THEIR OWN specific appointment (e.g., 'when is my appointment', 'what time is my booking', 'can you check my appointment'). Route to identification first."
            }
          },
          {
            "destination_node_id": "node-1759267476271",
            "id": "edge-1759286128401",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller asks general business questions about services, hours, policies, or procedures (NOT about their specific appointment)."
            }
          },
          {
            "destination_node_id": "node-1759285368491",
            "id": "edge-1",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to schedule a new appointment."
            }
          },
          {
            "destination_node_id": "node-1759299298668",
            "id": "edge-2",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to modify an existing appointment."
            }
          },
          {
            "destination_node_id": "node-1759299298668",
            "id": "edge-1759286143486",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to cancel an existing appointment."
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759305738582",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller indicates they are ready to end the conversation."
            }
          },
          {
            "destination_node_id": "node-1759286205338",
            "id": "edge-1759286706982",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to speak with a human representative."
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759286171992",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller's intent is unclear or does not match defined categories."
            }
          }
        ],
        "global_node_setting": {
          "condition": "Caller modifies their request or expresses unclear intent requiring re-routing."
        },
        "start_speaker": "agent",
        "id": "start-node-1759266611426",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 1277,
          "y": 2538
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nAnswer general business questions using knowledge base first, escalate to Answer Question tool if needed.\n\n## Information Available\nBusiness: {{business_name}} - {{business_description}}\nHours: {{business_hours}} ({{business_timezone}})\nServices: {{appointment_types}}\nPhone: {{transfer_phone_number}}\n\n## Response Strategy\n- Try knowledge base first for: hours, services, policies, contact info\n- Keep responses to 1-2 sentences\n- Be conversational and helpful\n- If knowledge insufficient → Use Answer Question tool\n\n## Simple Questions (Answer Directly)\n- Business hours, location, phone number\n- Basic service descriptions and pricing\n- Cancellation and booking policies\n- Contact information\n\n## Complex Questions (Use Tool)\n- Specific availability or scheduling\n- Detailed service comparisons\n- Real-time information or current promotions\n- Technical or specialized questions\n\n## Transition Triggers\n- If question answered successfully → Ask \"Is there anything else I can help you with?\"\n- If knowledge base insufficient → Use Answer Question tool\n- If caller wants to book after getting info → Route to appointment booking"
        },
        "name": "Answer Question",
        "edges": [
          {
            "destination_node_id": "node-1759288307521",
            "id": "edge-1759754099768",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Knowledge base lacks sufficient information to answer the question."
            }
          },
          {
            "destination_node_id": "node-1759288307521",
            "id": "edge-1759286493146",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller disputes the answer or needs additional details."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759267974537",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Question has been successfully answered and caller is satisfied."
            }
          },
          {
            "destination_node_id": "node-1759288307521",
            "id": "edge-1759885350328",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Question requires real-time or contextual information beyond knowledge base."
            }
          }
        ],
        "id": "node-1759267476271",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 1777,
          "y": 751
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nCollect callback information for leads who can't complete their request immediately.\n\n## Required Information\n- Name\n- Phone number\n- Email address\n- Reason for callback/service interest\n- Any additional notes\n\n## Collection Approach\n- Keep conversation natural and helpful\n- Explain: \"I'd be happy to have someone call you back\"\n- Ask for information one field at a time\n- Acknowledge each response\n- Keep responses brief and conversational\n\n## Business Context\nBusiness: {{business_name}} - {{business_description}}\nCallback during: {{business_hours}}\n\n## Conversation Flow\n1. \"What's the best name for the callback?\"\n2. \"And what's a good phone number to reach you?\"\n3. \"What's your email address?\"\n4. \"What can we help you with when we call back?\"\n\n## Transition Triggers\n- When all required information collected → Call logLead function\n- If caller declines callback → Route to graceful goodbye\n- If caller wants human immediately → Route to transfer"
        },
        "name": "Log Lead",
        "edges": [
          {
            "destination_node_id": "node-1759295548716",
            "id": "edge-1759267848412",
            "transition_condition": {
              "type": "prompt",
              "prompt": "All required lead information has been collected for callback."
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759297549853",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller declines callback offer."
            }
          },
          {
            "destination_node_id": "node-1759286205338",
            "id": "edge-1759301888114",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to speak with a human representative."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759267848412-router",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller changes request or asks about different topic."
            }
          }
        ],
        "id": "node-1759267848412",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 4277,
          "y": 2441
        }
      },
      {
        "name": "End Call",
        "id": "node-1759285139512",
        "type": "end",
        "display_position": {
          "x": 6277,
          "y": 3392
        },
        "instruction": {
          "type": "prompt",
          "text": "End call professionally."
        }
      },
      {
        "custom_sip_headers": {},
        "transfer_destination": {
          "type": "predefined",
          "number": "+17734699726"
        },
        "edge": {
          "destination_node_id": "node-1759267848412",
          "id": "edge-1759285209751",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Transfer failed"
          }
        },
        "instruction": {
          "type": "prompt",
          "text": "Inform the caller that their call is being transferred to a human representative."
        },
        "name": "Transfer Call",
        "id": "node-1759285209751",
        "transfer_option": {
          "type": "cold_transfer",
          "show_transferee_as_caller": false
        },
        "type": "transfer_call",
        "display_position": {
          "x": 5277,
          "y": 3202
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nCollect complete appointment information including service-specific properties before booking.\n\n## Required Information\n- Customer details: name, phone, email, preferred contact method\n- Appointment details: date, time, service type\n- Service-specific properties: varies by service selected\n- Additional notes if provided\n\n## Collection Approach\n- Ask ONE question at a time\n- Acknowledge each response: \"Got it, [repeat what they said]\"\n- Collect basic info first, then service-specific properties\n- Confirm understanding before moving to next question\n- Keep responses conversational and natural\n\n## Service Options\nAvailable services: {{appointment_types}}\nBusiness hours: {{business_hours}} ({{business_timezone}})\n\n## Confirmation Protocol\nBefore booking, summarize ALL collected information:\n\"Let me confirm: [name] at [phone], [service] on [date] at [time], [service properties]. Is this correct?\"\n\n## Transition Triggers\n- When ALL required fields collected AND caller confirms details → Move to booking function\n- If caller says \"never mind\", \"cancel\", \"forget it\" → Return to router\n- If caller changes their mind about details → Continue collection with new information\n\nCurrent date/time: {{dayAndTime}}\nTimezone: {{timezone}}"
        },
        "name": "Gather New Appointment Details",
        "edges": [
          {
            "destination_node_id": "node-1759287172272",
            "id": "edge-1759285368491",
            "transition_condition": {
              "type": "prompt",
              "prompt": "ALL required fields collected (including service-specific properties) AND caller explicitly confirmed details are correct."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759299265144",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller explicitly cancels booking ('never mind', 'cancel that', 'forget it'). Clarifying questions do NOT trigger this."
            }
          }
        ],
        "id": "node-1759285368491",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 2685.5714285714284,
          "y": 133.28571428571425
        }
      },
      {
        "name": "Escalation Logic",
        "edges": [
          {
            "destination_node_id": "node-1759285209751",
            "id": "edge-1759286308989",
            "transition_condition": {
              "type": "prompt",
              "prompt": "The call is received during designated AI support hours when human transfer is available."
            }
          }
        ],
        "id": "node-1759286205338",
        "else_edge": {
          "destination_node_id": "node-1759267848412",
          "id": "edge-1759286205338",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Else"
          }
        },
        "type": "branch",
        "display_position": {
          "x": 4777,
          "y": 2989
        }
      },
      {
        "tool_id": "tool-1759287159165",
        "name": "Book Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759287359647",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759287611013",
            "id": "edge-1759287496188",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759287505026",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759287172272",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 3777,
          "y": 274
        },
        "wait_for_result": true
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nHandle booking failures by explaining the issue and collecting corrected information.\n\n## Process\n1. Acknowledge the booking issue professionally\n2. Explain what went wrong (if provided by tool response)\n3. Identify which information needs correction\n4. Guide caller to provide corrected details\n\n## Common Issues\n- Time slot unavailable\n- Date outside business hours\n- Missing required service properties\n- Invalid contact information format\n\n## Approach\n- Stay positive: \"Let me help you fix that\"\n- Be specific about what needs correction\n- Only ask for the problematic fields\n- Suggest alternatives when possible\n\n## Business Context\nBusiness hours: {{business_hours}}\nServices: {{appointment_types}}\n\n## Examples\n- \"That time slot isn't available. What about [alternative time]?\"\n- \"I need a 10-digit phone number. What's your phone number?\"\n- \"For [service], I also need [property]. Can you provide that?\"\n\n## Transition Triggers\n- When corrected information provided → Return to appointment collection\n- If caller gives up booking → Route to goodbye\n- If caller wants different service/time → Continue with new requirements"
        },
        "name": "Re-Verify Appointment Details",
        "edges": [
          {
            "destination_node_id": "node-1759285368491",
            "id": "edge-1759287611013",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller provides corrected appointment information."
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759290069897",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller decides to abandon appointment booking."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759306509467",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to do something else."
            }
          }
        ],
        "id": "node-1759287611013",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 4277,
          "y": 0
        }
      },
      {
        "tool_id": "tool-1759288305078",
        "name": "Answer Question",
        "edges": [
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759294852015",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759298254864",
            "id": "edge-1759294865725",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759294859184",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759288307521",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 3277,
          "y": 1156
        },
        "wait_for_result": true
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nSummarize completed actions and ensure caller satisfaction before ending.\n\n## Process\n1. Review what was accomplished based on tool results\n2. Verify the action was successful\n3. Provide confirmation details if applicable\n4. Ask if they need anything else\n\n## Confirmation Examples\n- Appointment booked: \"Perfect! I've scheduled your [service] for [date] at [time]. You should receive a confirmation shortly.\"\n- Appointment modified: \"Great! I've updated your appointment to [new details].\"\n- Appointment cancelled: \"Your appointment has been cancelled as requested.\"\n- Lead logged: \"Thanks! Someone from {{business_name}} will call you back during business hours.\"\n\n## Business Context\nBusiness: {{business_name}}\nHours: {{business_hours}}\n\n## Final Check\nAlways ask: \"Is there anything else I can help you with today?\"\n\n## Transition Triggers\n- If caller confirms they're done → Route to goodbye\n- If caller has another request → Return to router\n- If caller seems uncertain about completed action → Provide additional confirmation"
        },
        "name": "End Call Confirmation",
        "edges": [
          {
            "destination_node_id": "node-1759778806299",
            "id": "edge-1759289883915",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller confirms they are ready to end the conversation."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759290019289",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller has another request."
            }
          }
        ],
        "id": "node-1759289883915",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 5277,
          "y": 212
        }
      },
      {
        "tool_id": "tool-1759295546196",
        "name": "Log Lead",
        "edges": [
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759297634561",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759867986545",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759301979878",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759295548716",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 4777,
          "y": 274
        },
        "wait_for_result": true
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nHandle situations where questions cannot be answered, offering alternatives.\n\n## Response Strategy\n1. Acknowledge the limitation professionally\n2. Apologize briefly without over-explaining\n3. Offer specific alternatives\n4. Keep response helpful and solution-oriented\n\n## Alternative Offerings\n- Callback from knowledgeable staff\n- Transfer to human representative (if available)\n- Different type of assistance\n- Basic information that might help\n\n## Professional Responses\n- \"I don't have that specific information, but I can have someone who specializes in [topic] call you back.\"\n- \"Let me connect you with someone who can better help with that question.\"\n- \"I can help you with [alternative] instead, or arrange a callback for more detailed information.\"\n\n## Business Context\nBusiness: {{business_name}}\nCallback hours: {{business_hours}}\nTransfer available during: {{ai_support_hours}}\n\n## Transition Triggers\n- If caller accepts callback → Route to lead collection\n- If caller wants to continue with different request → Return to router\n- If caller ready to end call → Route to goodbye"
        },
        "name": "Q/A Fail",
        "edges": [
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759298359614",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller accepts callback offer for unanswered question."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759298254864",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller wants to continue with different request."
            }
          },
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759298254864-end",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller is ready to end the conversation."
            }
          }
        ],
        "id": "node-1759298254864",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 3777,
          "y": 1869
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nCollect identifying information to locate caller's existing appointment using identifyAppointment function.\n\n## Required Information\n- Caller's phone number (primary identifier)\n- OR caller's full name\n- Optional: approximate appointment date if needed\n\n## Conversation Approach\n- Ask naturally: \"What's the best phone number to look up your appointment?\" OR \"What name is the appointment under?\"\n- Keep responses under 2 sentences\n- Acknowledge: \"Perfect, let me look that up for you\"\n- If first search fails, try alternative identifier\n\n## Business Context\nBusiness: {{business_name}}\nCurrent time: {{dayAndTime}} ({{business_timezone}})\n\n## Function Call Process\n1. Collect phone number or name\n2. Call `identifyAppointment` function with collected data\n3. Wait for function response before proceeding\n\n## Transition Triggers\n- When sufficient identifying info collected → Call identifyAppointment function\n- If caller cannot provide phone or name → Route to lead collection\n- If caller changes topic → Return to router\n\nCurrent date/time: {{dayAndTime}}\nTimezone: {{timezone}}"
        },
        "name": "Identify Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759299579503",
            "id": "edge-1759299298668",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Sufficient identifying information has been collected."
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759299413073",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller cannot provide sufficient identifying information."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759299298668-router",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller changes request or asks about different topic."
            }
          }
        ],
        "id": "node-1759299298668",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 1777,
          "y": 1633
        }
      },
      {
        "tool_id": "tool-1759299574542",
        "name": "Identify Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759299860372",
            "id": "edge-1759299602214",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759299298668",
            "id": "edge-1759299791730",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759299800128",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759299579503",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 2277,
          "y": 1696
        },
        "wait_for_result": true
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nConfirm appointment details found and route based on caller's specific intent.\n\n## Process\n1. Summarize appointment details from identifyAppointment results\n2. Confirm this is the correct appointment\n3. Ask what they'd like to do with this appointment\n4. Route based on their response\n\n## Response Format\n\"I found your appointment: [service] on [date] at [time]. Is this the appointment you're calling about?\"\n\n## Routing Options\n- Questions about the appointment → Use Answer Question tool with appointment context\n- Modify/reschedule the appointment → Route to modification flow\n- Cancel the appointment → Route to cancellation flow\n- Satisfied with information → Return to router for other needs\n\n## Transition Triggers\n- If caller asks questions about their appointment → Route to Answer Question function\n- If caller says \"change\", \"modify\", \"reschedule\" → Route to modification collection\n- If caller says \"cancel\", \"remove\", \"delete\" → Route to cancellation function\n- If caller satisfied or changes topic → Return to router\n- If wrong appointment found → Return to identification with different search criteria"
        },
        "name": "Operate on Existing Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759288307521",
            "id": "edge-operate-answer",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller asks question about their identified appointment."
            }
          },
          {
            "destination_node_id": "node-1760010000000",
            "id": "edge-operate-modify",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to modify their identified appointment."
            }
          },
          {
            "destination_node_id": "node-1759300500941",
            "id": "edge-operate-cancel",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller requests to cancel their identified appointment."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-operate-abandon",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller satisfied or wants different topic."
            }
          }
        ],
        "id": "node-1759299860372",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 2777,
          "y": 1041
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nCollect specific fields caller wants to modify for their existing appointment.\n\n## Modifiable Fields\n- Date and time\n- Service type ({{appointment_types}})\n- Contact information (phone, email)\n- Service-specific properties\n- Additional notes\n\n## Collection Process\n- Ask: \"What would you like to change about your appointment?\"\n- Listen for specific field mentions\n- Collect ONLY the fields being changed\n- For each change, confirm: \"So you want to change [field] to [new value]?\"\n- Don't collect unchanged information\n\n## Business Context\nCurrent date/time: {{dayAndTime}}\nTimezone: {{business_timezone}}\nBusiness hours: {{business_hours}}\n\n## Validation\n- Ensure new date/time is within business hours\n- Verify service availability\n- Confirm service properties if service type changes\n\n## Transition Triggers\n- When all desired changes collected and confirmed → Move to modify function\n- If caller decides not to change anything → Return to router\n- If caller wants to cancel instead → Route to cancellation\n\nCurrent: {{dayAndTime}}\nTimezone: {{timezone}}"
        },
        "name": "Gather Modification Details",
        "edges": [
          {
            "destination_node_id": "node-1759300443418",
            "id": "edge-1760010000001",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller has confirmed all desired changes."
            }
          },
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1760010000002",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller cancels modification request."
            }
          }
        ],
        "id": "node-1760010000000",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 3277,
          "y": 751
        }
      },
      {
        "tool_id": "tool-1759300315801",
        "name": "Modify Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759301968646",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759287611013",
            "id": "edge-1759870963515",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759302058185",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759300443418",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 3777,
          "y": 751
        },
        "wait_for_result": true
      },
      {
        "tool_id": "tool-1759300498371",
        "name": "Cancel Appointment",
        "edges": [
          {
            "destination_node_id": "node-1759289883915",
            "id": "edge-1759301938699",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Success"
            }
          },
          {
            "destination_node_id": "node-1759287611013",
            "id": "edge-1759870980769",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Failure"
            }
          },
          {
            "destination_node_id": "node-1759267848412",
            "id": "edge-1759302005400",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Error"
            }
          }
        ],
        "id": "node-1759300500941",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 3777,
          "y": 2353
        },
        "wait_for_result": true
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nDeliver professional greeting and gather caller's initial request.\n\n## Greeting Format\n\"Hello, thank you for calling {{business_name}}. This is {{agent_name}}. How can I help you today?\"\n\n## Approach\n- Be warm and professional\n- Speak clearly and at normal pace\n- Listen carefully to their COMPLETE response\n- Don't interrupt or ask them to repeat unless truly necessary\n- Show interest in helping them\n\n## Business Context\n{{business_name}} - {{business_description}}\nServices: {{appointment_types}}\nHours: {{business_hours}}\n\n## Transition Triggers\n- After caller responds with request → Route to Get Day and Time function first\n- If caller immediately wants to end call → Route to goodbye\n- Listen for keywords to prepare proper routing\n\n{{agent_name}}\n{{business_name}}"
        },
        "name": "Welcome",
        "edges": [
          {
            "destination_node_id": "node-1759778806299",
            "id": "edge-1759303421427",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller wishes to end the conversation immediately."
            }
          },
          {
            "destination_node_id": "node-1759818957400",
            "id": "edge-1759305123422",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Caller states their request or responds to greeting."
            }
          }
        ],
        "id": "node-1759303421427",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 227.03495591931744,
          "y": 3259.157896452243
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "## Task\nEnd the call professionally with appreciation and invitation to call back.\n\n## Farewell Format\n\"Thank you for calling {{business_name}}. Have a wonderful [day/evening]!\"\n\n## Approach\n- Express genuine appreciation\n- Keep it brief but warm\n- Match the time of day naturally\n- End on a positive note\n\n## Business Context\n{{business_name}} - {{business_description}}\nFuture contact: {{transfer_phone_number}}\nHours: {{business_hours}}\n\n## Optional Additions\n- \"Feel free to call us again if you need anything\"\n- \"We're here [business hours] to help\"\n- Keep additions brief and natural\n\n{{business_name}}"
        },
        "name": "Graceful Goodbye",
        "edges": [
          {
            "id": "edge-1759778806299",
            "transition_condition": {
              "type": "prompt",
              "prompt": "Describe the transition condition"
            }
          }
        ],
        "id": "node-1759778806299",
        "knowledge_base_ids": [],
        "type": "conversation",
        "display_position": {
          "x": 5777,
          "y": 3282
        },
        "skip_response_edge": {
          "destination_node_id": "node-1759285139512",
          "id": "edge-1759778889986",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Skip response"
          }
        }
      },
      {
        "tool_id": "tool-1759818955040",
        "name": "Get Day and Time",
        "edges": [
          {
            "destination_node_id": "start-node-1759266611426",
            "id": "edge-1759821057178",
            "transition_condition": {
              "type": "equation",
              "equations": [
                {
                  "left": "{{dayAndTime}}",
                  "operator": "exists"
                }
              ],
              "operator": "&&"
            }
          }
        ],
        "id": "node-1759818957400",
        "type": "function",
        "tool_type": "local",
        "speak_during_execution": false,
        "display_position": {
          "x": 708.9245209331547,
          "y": 3247.266935455671
        },
        "wait_for_result": true
      }
    ],
    "start_node_id": "node-1759303421427",
    "start_speaker": "agent",
    "tools": [
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "Books an appointment.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook/bookAppointment",
        "tool_id": "tool-1759287159165",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "bookAppointment",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "required": ["name", "date", "time", "phone", "timezone", "service"],
          "properties": {
            "date": {
              "type": "string",
              "description": "Appointment date in YYYY-MM-DD format"
            },
            "notes": {
              "type": "string",
              "description": "Any additional notes as plain language."
            },
            "phone": {
              "type": "string",
              "description": "10-digit phone number, optional extension (e.g., 1234567890x123)"
            },
            "timezone": {
              "type": "string",
              "description": "Timezone for the appointment (e.g., America/Chicago). Use value from dayAndTime tool."
            },
            "service": {},
            "name": {
              "type": "string",
              "description": "Full name of the caller"
            },
            "time": {
              "type": "string",
              "description": "Appointment time in 24-hour format HH:MM (local time)"
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "Answers questions using RAG agent with Google Calendar, Drive, and Sheets access. Two modes: (1) General business questions without context, (2) Identified caller's appointment questions with context populated from identifyAppointment.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook-test/answerQuestion",
        "tool_id": "tool-1759288305078",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "answerQuestion",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "properties": {
            "question": {
              "type": "string",
              "description": "The caller's question. For general business questions, this can be any company-related query. For personal appointment questions, only use after identifyAppointment verification."
            },
            "context": {
              "type": "string",
              "description": "Optional. Leave empty for general business questions. Populate with appointment details from identifyAppointment response when caller asks about their specific appointment. RAG uses this to provide personalized answers while protecting other customers' privacy."
            }
          },
          "required": ["question"]
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "Logs a lead/callback request.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook/logLead",
        "tool_id": "tool-1759295546196",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "logLead",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "required": ["phone", "name", "email"],
          "properties": {
            "name": {
              "type": "string",
              "description": "Caller’s full name, if provided."
            },
            "service_interest": {
              "type": "string",
              "description": "The service or product the caller expressed interest in."
            },
            "notes": {
              "type": "string",
              "description": "Free-form notes about the conversation, unanswered questions, or follow-up needed."
            },
            "phone": {
              "type": "string",
              "description": "Caller’s phone number, if provided."
            },
            "email": {
              "type": "string",
              "description": "Caller’s email address, if provided."
            },
            "timestamp": {
              "type": "string",
              "description": "Time the lead was logged."
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "Searches for appointments in Google Calendar and spreadsheet records using provided search criteria. Returns matching appointment details including appointment_id needed for modifications or cancellations.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook/identifyAppointment",
        "tool_id": "tool-1759299574542",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "identifyAppointment",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "required": ["name", "phone"],
          "properties": {
            "name": {
              "type": "string",
              "description": "Caller's full name to search for in appointment records."
            },
            "date": {
              "type": "string",
              "description": "Appointment date in YYYY-MM-DD format to narrow search results."
            },
            "context": {
              "type": "string",
              "description": "Additional contextual information that might help identify the appointment (e.g., service type, approximate time)."
            },
            "phone": {
              "type": "string",
              "description": "Caller's phone number to search for in appointment records."
            },
            "query": {
              "type": "string",
              "description": "Natural language search query combining any details the caller provided (e.g., 'haircut appointment next Tuesday' or 'John Smith 2pm')."
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "Modifies an existing appointment. Only include fields being changed in the updates object.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook-test/modifyAppointment",
        "tool_id": "tool-1759300315801",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "modifyAppointment",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "required": ["appointment_id", "updates"],
          "properties": {
            "updates": {
              "type": "object",
              "description": "Object containing ONLY the fields to be changed. Available fields: name, date (YYYY-MM-DD), time (HH:MM 24-hour), phone, service, timezone, notes.",
              "properties": {
                "date": {
                  "type": "string",
                  "description": "Updated appointment date in YYYY-MM-DD format"
                },
                "notes": {
                  "type": "string",
                  "description": "Updated appointment notes"
                },
                "phone": {
                  "type": "string",
                  "description": "Updated phone number"
                },
                "service": {},
                "timezone": {
                  "type": "string",
                  "description": "Updated IANA timezone (e.g., 'America/Chicago'). Use {{timezone}} variable."
                },
                "name": {
                  "type": "string",
                  "description": "Updated customer name"
                },
                "time": {
                  "type": "string",
                  "description": "Updated appointment time in HH:MM 24-hour format"
                }
              }
            },
            "appointment_id": {
              "type": "string",
              "description": "Google Calendar Event ID from identifyAppointment response (use EXACT value)."
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "Cancels an appointment.",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook-test/cancelAppointment",
        "tool_id": "tool-1759300498371",
        "args_at_root": true,
        "timeout_ms": 120000,
        "name": "cancelAppointment",
        "response_variables": {},
        "parameters": {
          "type": "object",
          "required": ["appointment_id"],
          "properties": {
            "appointment_id": {
              "type": "string",
              "description": "Backend-specific identifier for the appointment (Google Calendar event.id, CRM booking ID, etc.)."
            },
            "reason": {
              "type": "string",
              "description": "Optional reason for cancellation provided by the caller."
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "GET",
        "query_params": {},
        "description": "Gets day and time",
        "type": "custom",
        "url": "https://n8n.srv836523.hstgr.cloud/webhook/dayAndTime",
        "tool_id": "tool-1759818955040",
        "args_at_root": false,
        "timeout_ms": 120000,
        "name": "dayAndTime",
        "response_variables": {
          "timezone": "data.timezone",
          "dayAndTime": "data.currentDate"
        },
        "parameters": {
          "type": "object",
          "properties": {},
          "required": []
        }
      }
    ],
    "model_choice": {
      "type": "cascading",
      "model": "claude-4.5-sonnet",
      "high_priority": true
    },
    "model_temperature": 0,
    "tool_call_strict_mode": true,
    "default_dynamic_variables": {},
    "knowledge_base_ids": [],
    "kb_config": {
      "top_k": 4,
      "filter_score": 0.6
    },
    "begin_tag_display_position": {
      "x": 0,
      "y": 3406
    },
    "is_published": false
  },
  "llmURL": null
}
